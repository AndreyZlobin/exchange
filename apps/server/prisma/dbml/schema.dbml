//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Table Log {
  id String [pk]
  action String
  source String
  data Json
  created DateTime [default: `now()`]
}

Table Claim {
  id String [pk]
  uuid String [not null]
  order_id Int
  order_status String
  deal_id Int
  fiat_amount Float
  fiat_amount_order Float
  status String
  error String
  provider String
  client_name String
  handler String
  payment_system String
  created DateTime
  images Json
  savedImages Json
  urls Json
}

Table PaymentSystem {
  id String [pk]
  name SystemEnum [not null]
  type SystemEnum [not null, note: 'Все допустимые системы оплаты']
  min Int [not null, note: 'Минимальные и максимальные суммы заявок по платежным системам']
  max Int [not null, note: 'Минимальные и максимальные суммы заявок по платежным системам']
  brokerCommission Int [not null, note: 'Комиссии посредника (если таковой имеется)']
  systemCommission Int [not null, note: 'Комиссии по платежным системам']
  isAllow Boolean [not null, default: false, note: 'Доступ к созданию заявок по платежным системам']
  orders Order [not null]
}

Table Order {
  id String [pk]
  status OrderStatus [not null, default: 'new']
  user User [not null]
  userId String [unique, not null]
  paymentSystem PaymentSystem [not null]
  paymentSystemId String [not null]
  statusHistory OrderStatus[] [not null]
  created DateTime [default: `now()`]
  deleted Boolean [default: false]
}

Table Wallet {
  id String [pk]
  balance Float [not null, default: 0, note: 'Текущий баланс пользователя']
  balanceDep Float [not null, default: 0, note: 'Активный баланс пользователя']
  address String [not null, note: 'Адрес кошелька для системы автосписания депозитов']
  walletDepositCheckAmount Int [not null, note: 'Сумма проверки для системы автосписания депозитов']
  userId String [unique, not null]
  user User [not null]
  deleted Boolean [default: false]
}

Table PaymentSetting {
  id String [pk]
  systems Systems [not null]
  userId String [unique, not null]
  user User [not null]
  deleted Boolean [default: false]
}

Table Currency {
  id String [pk]
  name CurrencyType [not null]
  title String [not null]
  type CryptocurrencyType [not null]
}

Table User {
  id String [pk]
  name String [not null]
  password String [not null]
  role RoleEnum[] [not null]
  active Boolean [not null, default: true, note: 'Активен ли аккаунт, если нет, то нет доступ ко всему функционалу запрещен']
  orders Order [not null]
  wallet Wallet
  paymentSetting PaymentSetting
  deleted Boolean [default: false]
}

Enum SystemEnum {
  ccard
  sim
  qiwi
  yandex
}

Enum CryptocurrencyType {
  Cryptocurrency
  Fiat
}

Enum CurrencyType {
  Tether
  BTC
}

Enum RoleEnum {
  superadmin
  admin
  broker
  provider
  seller
  support
}

Enum OrderStatus {
  new
  dealAdded
  dealCanceled
  dealCanceledMarkedPaid
  requisiteAdded
  markedPaid
  finished
  canceled
  claim
  renew
  waitFinishTx
  finishError
}

Ref: Order.userId > User.id [delete: Cascade]

Ref: Order.paymentSystemId > PaymentSystem.id [delete: Cascade]

Ref: Wallet.userId - User.id [delete: Cascade]

Ref: PaymentSetting.userId - User.id [delete: Cascade]